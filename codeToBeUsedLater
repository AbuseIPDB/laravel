/* makes call to the reports endpoint of api */
    public function reports($ipAddress, $maxAgeInDays = null, $page = null, $perPage = null) : ?Response {

        $parameters = ['ipAddress' => $ipAddress];

        //only send nullable parameters if present
        if(isset($maxAgeInDays)){ $parameters['maxAgeInDays'] = $maxAgeInDays; }
        if(isset($page)){ $parameters['page'] = $page; }
        if(isset($perPage)){ $parameters['perPage'] = $perPage; }
        
        return $this->makeRequest('reports', 'get', $parameters);
    }

    /* makes call to the blacklist endpoint of api */
     public function blackList($plaintext = null, $confidenceMinimun = null, $limit = null, $onlyCountries = null, $exceptCountries = null, $ipVersion = null) : ?Response {
        $parameters = [];

        if(isset($confidenceMinimum)){ $parameters['confidenceMinimum'] = $confidenceMinimum; }
        if(isset($limit)){ $parameters['limit'] = $limit; }
        if(isset($onlyCountries)){ $parameters['onlyCountries'] = $onlyCountries; }
        if(isset($exceptCountries)){ $parameters['exceptCountries'] = $exceptCountries; }
        if(isset($ipVersion)){ $parameters['ipVersion'] = $ipVersion; }
 
        return isset($plaintext) ?  $this->makeRequest('blacklist', 'get', $parameters, 'text/plain') : $this->makeRequest('blacklist', 'get', $parameters);
    
    } 

    /* makes call to check-block endpoint of api */
    public function checkBlock($network, $maxAgeInDays = null) : ?Response  {

        $parameters = ['network' => $network];

        if(isset($maxAgeInDays)){ $parameters['maxAgeInDays'] = $maxAgeInDays;}

        return $this->makeRequest('check-block', 'get', $parameters);
    }

    /* makes call to bulk-report endpoint of api */
    public function bulkReport($file) : ?Response {

        $parameters = ['multipart' => [
            'name' => 'csv',
            'contents' => fopen($file, 'r')
        ]];

        return $this->makeRequest('bulk-report', 'post', $parameters);
    }

    /* makes call to clear-address endpoint of api */
    public function clearAddress($ipAddress) : ?Response {

        $parameters = ['ipAddress' => $ipAddress];

        return $this->makeRequest('clear-address', 'delete', $parameters);
    }